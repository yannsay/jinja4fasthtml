# core


I wanted to use Jinja templates with FastHTML to separate front-end and
back-end concerns, but this wasn’t directly supported. So I created
`fastjinja` to bridge that gap.

I have explored how I could get Jinja templates how to fit into the
literrate programing with notebook, FastHTML and re-iterating rapidly
within the notebook. I present you `fastjinja`.

*When skiming throught hypermedia.systems, I was also very glad to see
they are using jinja! Maybe next step will be re-writing hypermedia
system with fasthtml and jinja.*

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Writing Jinja from notebook

Template from jinja2 conflict with another Template. That’s why I import
jinja2 as jinja2

``` python
app = FastHTML()
rt = app.route
```

``` python
jinja_template = """<div> {{ name }} </div>
"""
jinja_template
```

    '<div> {{ name }} </div>\n'

``` python
template = jinja2.Template(jinja_template)
template
```

    <Template memory:7b0e377075c0>

``` python
template.render(name="Yann")
```

    '<div> Yann </div>'

``` python
@rt
def jinja_ex(name):
    return template.render(name=name)

jinja_ex(name="Yann")
```

    '<div> Yann </div>'

``` python
jinja_template2 = """<ul>
  {% for user in users %}
    <li><a href="{{ user.url }}">{{ user.username }}</a></li>
  {% endfor %}
  </ul>
"""
jinja_template2
```

    '<ul>\n  {% for user in users %}\n    <li><a href="{{ user.url }}">{{ user.username }}</a></li>\n  {% endfor %}\n  </ul>\n'

``` python
template2 = jinja2.Template(jinja_template2)
template2
```

    <Template memory:7b0e382e2ab0>

``` python
users_ex = [{"username":"Yann", "url":"yann@yann.yann"}, {"username":"Pierre", "url":"pierre@pierre.pierre"}]
users_ex
```

    [{'username': 'Yann', 'url': 'yann@yann.yann'},
     {'username': 'Pierre', 'url': 'pierre@pierre.pierre'}]

``` python
@rt
def jinja_ex2(users):
    return template2.render(users=users)

jinja_ex2(users=users_ex)
```

    '<ul>\n  \n    <li><a href="yann@yann.yann">Yann</a></li>\n  \n    <li><a href="pierre@pierre.pierre">Pierre</a></li>\n  \n  </ul>'

### Converting Jinja to FastHTML

``` python
def get_preview(app):
    return partial(HTMX, app=app, host=None, port=None)
preview = get_preview(app)
```

``` python
c = Div(P('hi'), style='color:red')
print(c)
```

    <div style="color:red"><p>hi</p></div>

``` python
preview(c)
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_XJDyO1_ITiGPv270zTx2yw&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
     &lt;div style=&quot;color:red&quot;&gt;
       &lt;p&gt;hi&lt;/p&gt;
     &lt;/div&gt;
   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
type(c)
```

    fastcore.xml.FT

``` python
c.__dict__
```

    {'tag': 'div',
     'children': (p(('hi',),{}),),
     'attrs': {'style': 'color:red'},
     'void_': False,
     'listeners_': []}

``` python
jt = """<div style="color:red"><p>hi</p></div>"""
```

``` python
template = jinja2.Template(jt)
```

``` python
template.render()
```

    '<div style="color:red"><p>hi</p></div>'

``` python
preview(template.render())
```

<iframe src="<div style="color:red"><p>hi</p></div>" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
type(template.render())
```

    str

I need to create the same fastcore.xml.FT element using the ft function
and bs4

------------------------------------------------------------------------

### parse_html_to_ft

``` python

def parse_html_to_ft(
    html_str:str
):

```

*Parse html to fastcore.xml*

``` python
ft_template = parse_html_to_ft(template.render())
ft_template
```

``` html
<div style="color:red">
  <p>hi</p>
</div>
```

``` python
preview(ft_template)
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_yiVuSL0HSsCQHTwNGqUAhQ&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
     &lt;div style=&quot;color:red&quot;&gt;
       &lt;p&gt;hi&lt;/p&gt;
     &lt;/div&gt;
   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
type(ft_template)
```

    fastcore.xml.FT

``` python
ft_template.__dict__
```

    {'tag': 'div',
     'children': (p(('hi',),{}),),
     'attrs': {'style': 'color:red'},
     'void_': False,
     'listeners_': []}

Now I can patch the jinja2.Template to have a module for fasthtml

------------------------------------------------------------------------

### Template.ft_render

``` python

def ft_render(
    args:VAR_POSITIONAL, kargs:VAR_KEYWORD
):

```

*parse html to fastcore.xml.ft and render*

I am checking with my previous example also.

``` python
preview(template.ft_render())
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_ATtdXFcsRpaeSaqfyyPVZQ&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
     &lt;div style=&quot;color:red&quot;&gt;
       &lt;p&gt;hi&lt;/p&gt;
     &lt;/div&gt;
   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
jinja_template = """<div> {{ name }} </div>
"""
jinja_template
```

    '<div> {{ name }} </div>\n'

``` python
template = jinja2.Template(jinja_template)
template
```

    <Template memory:7b0e36d15520>

``` python
preview(template.render(name="Yann"))
```

<iframe src="<div> Yann </div>" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
preview(template.ft_render(name="Yann"))
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_c76VpSkeQSKIa_IZIwIvOw&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
     &lt;div&gt; Yann &lt;/div&gt;
   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

## Reproducing (testing?)

### Writing SolveIt in SolveIt with Jinja

I will test some the first steps of lesson 4

#### Interactivity

``` python
from fastcore.utils import *
from fasthtml.common import *
from fasthtml.jupyter import *
import fasthtml.components as fc
import httpx
```

``` python
daisy_hdrs = (
    Link(href='https://cdn.jsdelivr.net/npm/daisyui@5', rel='stylesheet', type='text/css'),
    Script(src='https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4'),
    Link(href='https://cdn.jsdelivr.net/npm/daisyui@5/themes.css', rel='stylesheet', type='text/css')
)
```

``` python
app = FastHTML(hdrs=daisy_hdrs)
rt = app.route
```

``` python
def get_preview(app):
    return partial(HTMX, app=app, host=None, port=None)
preview = get_preview(app)
```

``` python
@rt
def proc_btn(): return f'hi'

@rt
def testbtn():
    return Div(
        Button('click me', hx_post=proc_btn, id='btn', hx_target='#test', cls='btn'),
        Div(id='test')
    )
```

``` python
preview(testbtn())
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_w81KtcpWQ56RMdaaEz_f1g&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5/themes.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
     &lt;div&gt;
&lt;button hx-post=&quot;/proc_btn&quot; hx-target=&quot;#test&quot; id=&quot;btn&quot; class=&quot;btn&quot; name=&quot;btn&quot;&gt;click me&lt;/button&gt;       &lt;div id=&quot;test&quot;&gt;&lt;/div&gt;
     &lt;/div&gt;
   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

Tip: There is https://h2f.answer.ai/ to convert html to fasthtml. To
convert fasthml to html just run the code and copy. It will not work for
everything but that’s a good start.

``` python
Div(
        Button('click me', hx_post=proc_btn, id='btn', hx_target='#test', cls='btn'),
        Div(id='test')
    )
```

``` html
<div>
<button hx-post="/proc_btn" hx-target="#test" id="btn" class="btn" name="btn">click me</button>  <div id="test"></div>
</div>
```

``` python
testbtn_template = jinja2.Template("""<div>
<button hx-post="/proc_btn" hx-target="#test" id="btn" class="btn" name="btn">click me</button>  <div id="test"></div>
</div>
""")
testbtn_template
```

    <Template memory:7b0e35b2f140>

``` python
@rt
def testbtn_jinja():
    return testbtn_template.ft_render()
```

``` python
preview(testbtn_jinja())
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_vKmMSJM7S8O2byOrYG-Qbg&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5/themes.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
     &lt;div&gt;
&#10;&lt;button hx-post=&quot;/proc_btn&quot; hx-target=&quot;#test&quot; id=&quot;btn&quot; class=&quot;btn&quot; name=&quot;btn&quot;&gt;click me&lt;/button&gt;        &lt;div id=&quot;test&quot;&gt;&lt;/div&gt;
&#10;     &lt;/div&gt;
   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

#### Getting data in a route

``` python
@rt
def getinp(): return Input(type='text', placeholder='Type here')
```

``` python
preview(getinp)
```

<iframe src="/getinp" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
getinp_template = jinja2.Template("<input type='text' placeholder='Type here'>")
```

``` python
@rt
def getinp_jinja():
    return getinp_template.ft_render()
```

``` python
preview(getinp_jinja())
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_eswyTIa6Q_OqrOXS9wPkqg&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5/themes.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
     &lt;input type=&quot;text&quot; placeholder=&quot;Type here&quot;&gt;&lt;/input&gt;
   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
def mk_comp(name, compcls):
    comp = getattr(fc, name)
    def wrapper(*args, cls='', **kwargs): return comp(*args, cls=f'{compcls} {cls}', **kwargs)
    globals()[name] = wrapper


mk_comp('Button', 'btn')
mk_comp('Input', 'input')
```

``` python
@rt
def proc_inp(inp:str): return f'hi {inp}'

@rt
def testinp():
    return Form(hx_post=proc_inp, hx_target='#test')(
        Input(type='text', placeholder='Type here', id='inp'),
        Button('say hi', type='submit'),
        Div(id='test')
    )
```

``` python
preview(testinp())
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_OKkfBmTgQ2ayhYuojNDb8w&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5/themes.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
&lt;form enctype=&quot;multipart/form-data&quot; hx-post=&quot;/proc_inp&quot; hx-target=&quot;#test&quot;&gt;       &lt;input type=&quot;text&quot; placeholder=&quot;Type here&quot; id=&quot;inp&quot; class=&quot;input &quot; name=&quot;inp&quot;&gt;
&lt;button type=&quot;submit&quot; class=&quot;btn &quot;&gt;say hi&lt;/button&gt;       &lt;div id=&quot;test&quot;&gt;&lt;/div&gt;
&lt;/form&gt;   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
form_jinja = jinja2.Template('''<form enctype="multipart/form-data" hx-post="/proc_inp" hx-target="#test">  <input type="text" placeholder="Type here" id="inp" class="input " name="inp">
<button type="submit" class="btn ">say hi</button>  <div id="test"></div>
</form>''')
```

``` python
@rt
def testinp_jinja():
    return form_jinja.ft_render()
```

``` python
preview(testinp_jinja())
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_yVFsoygWQimQ52DuhMLjHQ&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5/themes.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
&lt;form enctype=&quot;multipart/form-data&quot; hx-post=&quot;/proc_inp&quot; hx-target=&quot;#test&quot;&gt;        &lt;input type=&quot;text&quot; placeholder=&quot;Type here&quot; id=&quot;inp&quot; class=&quot;input&quot; name=&quot;inp&quot;&gt;&lt;/input&gt;
&#10;&lt;button type=&quot;submit&quot; class=&quot;btn&quot;&gt;say hi&lt;/button&gt;        &lt;div id=&quot;test&quot;&gt;&lt;/div&gt;
&#10;&lt;/form&gt;   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
def nameinp(oob=False):
    kw = dict(hx_swap_oob='true') if oob else {}
    return Input(type='text', placeholder='Type here', id='inp', **kw)

@rt
def proc_inp(inp:str): 
    return P(f'hi {inp}'), nameinp(True)

@rt
def testinp():
    return Form(hx_post=proc_inp, hx_target='#test', hx_swap='afterbegin')(
        nameinp(),
        Button('say hi', type='submit'),
        Div(id='test')
    )
```

``` python
preview(testinp())
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/__Xe3YpztR9e3cGTk3Xc69g&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5/themes.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
&lt;form enctype=&quot;multipart/form-data&quot; hx-post=&quot;/proc_inp&quot; hx-swap=&quot;afterbegin&quot; hx-target=&quot;#test&quot;&gt;       &lt;input type=&quot;text&quot; placeholder=&quot;Type here&quot; id=&quot;inp&quot; class=&quot;input &quot; name=&quot;inp&quot;&gt;
&lt;button type=&quot;submit&quot; class=&quot;btn &quot;&gt;say hi&lt;/button&gt;       &lt;div id=&quot;test&quot;&gt;&lt;/div&gt;
&lt;/form&gt;   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
def nameinp_jinja(oob=False):
    kw = dict(hx_swap_oob='true') if oob else {}
    return jinja2.Template('''
    <input type="text" placeholder="Type here" id="inp" class="input" name="inp" {% for key, value in kw.items() %}{{key}}="{{value}}"{% endfor %}>
''').ft_render(kw=kw)

@rt
def proc_inp_jinja(inp:str): 
    return jinja2.Template("<p> hi {{inp}}").ft_render(inp = inp), nameinp_jinja(True)

@rt
def testinp_jinja():
    return jinja2.Template('''<form enctype="multipart/form-data" hx-post="/proc_inp_jinja" hx-target="#test", hx_swap="afterbegin">  <input type="text" placeholder="Type here" id="inp" class="input " name="inp">
<button type="submit" class="btn ">say hi</button>  <div id="test"></div>
</form>''').ft_render()
```

``` python
preview(testinp_jinja())
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_ATbLptuqRs_oWBoQSkEDhA&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5/themes.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
&lt;form enctype=&quot;multipart/form-data&quot; hx-post=&quot;/proc_inp_jinja&quot; hx-target=&quot;#test&quot; hx-swap=&quot;afterbegin&quot;&gt;        &lt;input type=&quot;text&quot; placeholder=&quot;Type here&quot; id=&quot;inp&quot; class=&quot;input&quot; name=&quot;inp&quot;&gt;&lt;/input&gt;
&#10;&lt;button type=&quot;submit&quot; class=&quot;btn&quot;&gt;say hi&lt;/button&gt;        &lt;div id=&quot;test&quot;&gt;&lt;/div&gt;
&#10;&lt;/form&gt;   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

### Jinja style

I will now try how I use Jinja with FastHTML, reading a file and
checking inheritance.

#### From a file

``` python
jinja_template = """<div> {{ name }} </div>
"""
jinja_template
```

    '<div> {{ name }} </div>\n'

``` python
```

    mkdir: cannot create directory ‘templates’: File exists

``` python
with open("templates/example.html", "w") as f:
    f.write(jinja_template)
```

``` python
```

    example.html

I need to load the files from the environment

``` python
env = jinja2.Environment(loader=jinja2.FileSystemLoader('templates'))
```

``` python
template_from_file = env.get_template('example.html')
template_from_file
```

    <Template 'example.html'>

``` python
@rt
def example_from_file(name):
    return template_from_file.ft_render(name=name)
```

``` python
preview(example_from_file(name="Yann"))
```

<iframe srcdoc=" &lt;!doctype html&gt;
 &lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;FastHTML page&lt;/title&gt;
     &lt;link rel=&quot;canonical&quot; href=&quot;https://testserver/_qDjNKgjURmujtk9xGdOJ-g&quot;&gt;
     &lt;meta charset=&quot;utf-8&quot;&gt;
     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/fasthtml-js@1.0.12/fasthtml.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/answerdotai/surreal@main/surreal.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4&quot;&gt;&lt;/script&gt;     &lt;link href=&quot;https://cdn.jsdelivr.net/npm/daisyui@5/themes.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;script&gt;
    function sendmsg() {
        window.parent.postMessage({height: document.documentElement.offsetHeight}, &#x27;*&#x27;);
    }
    window.onload = function() {
        sendmsg();
        document.body.addEventListener(&#x27;htmx:afterSettle&#x27;,    sendmsg);
        document.body.addEventListener(&#x27;htmx:wsAfterMessage&#x27;, sendmsg);
    };&lt;/script&gt;   &lt;/head&gt;
   &lt;body&gt;
     &lt;div&gt; Yann &lt;/div&gt;
   &lt;/body&gt;
 &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

#### Inheritance

To correctly load the jinja templates, they should be in the
environment, so jinja knows what template exits.

In addition to load by folder, I am adding a DictLoader.

``` python
parent = """<!DOCTYPE html>
<html lang="en">
<head>
    {% block head %}
    <link rel="stylesheet" href="style.css" />
    <title>{% block title %}{% endblock %} - My Webpage</title>
    {% endblock %}
</head>
<body>
    <div id="content">{% block content %}{% endblock %}</div>
    <div id="footer">
        {% block footer %}
        &copy; Copyright 2008 by <a href="http://domain.invalid/">you</a>.
        {% endblock %}
    </div>
</body>
</html>
"""
```

``` python
child = """{% extends "parent.html" %}
{% block title %}Index{% endblock %}
{% block head %}
    {{ super() }}
    <style type="text/css">
        .important { color: #336699; }
    </style>
{% endblock %}
{% block content %}
    <h1>Index</h1>
    <p class="important">
      Welcome to my awesome homepage.
    </p>
{% endblock %}
"""
```

``` python
templates_dict={}

env = jinja2.Environment(loader=jinja2.ChoiceLoader([
    jinja2.DictLoader(templates_dict),
    jinja2.FileSystemLoader('templates')
]))
```

``` python
templates_dict["parent.html"]=parent
templates_dict
```

    {'parent.html': '<!DOCTYPE html>\n<html lang="en">\n<head>\n    {% block head %}\n    <link rel="stylesheet" href="style.css" />\n    <title>{% block title %}{% endblock %} - My Webpage</title>\n    {% endblock %}\n</head>\n<body>\n    <div id="content">{% block content %}{% endblock %}</div>\n    <div id="footer">\n        {% block footer %}\n        &copy; Copyright 2008 by <a href="http://domain.invalid/">you</a>.\n        {% endblock %}\n    </div>\n</body>\n</html>\n'}

``` python
parent_tp = env.get_template('parent.html')
parent_tp.ft_render()
```

``` html
<html lang="en">

  <head>

    <link rel="stylesheet" href="style.css"></link>

    <title> - My Webpage</title>

  </head>

  <body>

    <div id="content"></div>

    <div id="footer">

        
        © Copyright 2008 by <a href="http://domain.invalid/">you</a>.
        
        </div>

  </body>

</html>
```

``` python
preview(parent_tp.ft_render())
```

<iframe srcdoc=" &lt;html lang=&quot;en&quot;&gt;
&#10;   &lt;head&gt;
&#10;     &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;&lt;/link&gt;
&#10;     &lt;title&gt; - My Webpage&lt;/title&gt;
&#10;   &lt;/head&gt;
&#10;   &lt;body&gt;
&#10;     &lt;div id=&quot;content&quot;&gt;&lt;/div&gt;
&#10;     &lt;div id=&quot;footer&quot;&gt;
&#10;        
        © Copyright 2008 by &lt;a href=&quot;http://domain.invalid/&quot;&gt;you&lt;/a&gt;.
        &#10;         &lt;/div&gt;
&#10;   &lt;/body&gt;
&#10; &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
templates_dict['child.html'] = child
```

``` python
child_tp = env.get_template('child.html')
child_tp.ft_render()
```

``` html
<html lang="en">

  <head>

    <link rel="stylesheet" href="style.css"></link>

    <title>Index - My Webpage</title>

    <style type="text/css">
        .important { color: #336699; }
    </style>

  </head>

  <body>

    <div id="content">

      <h1>Index</h1>

      <p class="important">
      Welcome to my awesome homepage.
    </p>

    </div>

    <div id="footer">

        
        © Copyright 2008 by <a href="http://domain.invalid/">you</a>.
        
        </div>

  </body>

</html>
```

``` python
@rt
def child():
    return child_tp.ft_render()
```

``` python
preview(child())
```

<iframe srcdoc=" &lt;html lang=&quot;en&quot;&gt;
&#10;   &lt;head&gt;
&#10;     &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;&lt;/link&gt;
&#10;     &lt;title&gt;Index - My Webpage&lt;/title&gt;
&#10;     &lt;style type=&quot;text/css&quot;&gt;
        .important { color: #336699; }
    &lt;/style&gt;
&#10;   &lt;/head&gt;
&#10;   &lt;body&gt;
&#10;     &lt;div id=&quot;content&quot;&gt;
&#10;       &lt;h1&gt;Index&lt;/h1&gt;
&#10;       &lt;p class=&quot;important&quot;&gt;
      Welcome to my awesome homepage.
    &lt;/p&gt;
&#10;     &lt;/div&gt;
&#10;     &lt;div id=&quot;footer&quot;&gt;
&#10;        
        © Copyright 2008 by &lt;a href=&quot;http://domain.invalid/&quot;&gt;you&lt;/a&gt;.
        &#10;         &lt;/div&gt;
&#10;   &lt;/body&gt;
&#10; &lt;/html&gt;
" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.source !== frame.contentWindow) return; // Only proceed if the message is from this iframe
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

#### Correctly importing templates from code for inheritance

------------------------------------------------------------------------

### add_template_from_code

``` python

def add_template_from_code(
    templates_dict:dict, code:str, filename:str, env
):

```

*Correct way to add a Jinja template to get inheritance*
